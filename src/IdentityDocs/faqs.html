<!DOCTYPE html>
<html lang="en">
<head>
    <title>Comsoft Identity Server FAQ</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">    
    <link rel="shortcut icon" href="favicon.ico">  
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <!-- FontAwesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">   
    <!-- Plugins CSS -->    
    <link rel="stylesheet" href="assets/plugins/prism/prism.css">
    <link rel="stylesheet" href="assets/plugins/lightbox/dist/ekko-lightbox.css">
    <link rel="stylesheet" href="assets/plugins/elegant_font/css/style.css">

    <!-- Theme CSS -->
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css">
    
</head> 

<body class="body-purple">
    <div class="page-wrapper">
        <!-- ******Header****** -->
        <header id="header" class="header">
            <div class="container">
                <div class="branding">
                    <h1 class="logo">
                        <a href="index.html">
                            <span aria-hidden="true" class="icon_documents_alt icon"></span>
                            <span class="text-highlight">Comsoft Identity server</span><span class="text-bold">DOCS</span>
                        </a>
                    </h1>
                </div><!--//branding-->
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                    <li class="breadcrumb-item active">How To ?</li>
                </ol>
                
            </div><!--//container-->
        </header><!--//header-->
        <div class="doc-wrapper">
            <div class="container">
                
                <div class="doc-body row">
                    <div class="doc-content col-md-9 col-12 order-1">

                        <div class="content-inner">


                            <section id="Clients" class="doc-section">
                                <h2 class="section-title">Clients</h2>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How can I configure a new client in Identity server using database?</h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on Clients table</li>
                                                <li> Copy any record from the table</li>
                                                <li> Paste the record on the last record (empty record)</li>
                                                <li> Change the ClientID </li>
                                            </ul>
                                        </p>
                                        <div class="callout-block callout-success">
                                            <div class="icon-holder">
                                                <i class="fas fa-thumbs-up"></i>
                                            </div><!--//icon-holder-->
                                            <div class="content">
                                                <h4 class="callout-title">This table will help the developer to manage many primary client’s configurations and attributes like (not limited):</h4>
                                                <p> <strong>ClientName : </strong> Client display name (used for logging and consent screen). </p>
                                                <p> <strong>Enabled : </strong> Enabling disabling client. </p>
                                                <p> <strong>RequireConsent : </strong> Specifies whether a consent screen is required. Defaults to false. </p>
                                                <p> <strong>AllowOfflineAccess : </strong> Specifies whether this client can request refresh tokens (be requesting the offline_access scope). </p>
                                                <p> <strong>UserSsoLifetime  : </strong> The maximum duration (in seconds) since the last time the user authenticated. Defaults to null. You can adjust the lifetime of a session token to control when and how often a user is required to reenter credentials instead of being silently authenticated, when using a web application.. </p>
                                                <p> For further information <a href="DataClassModel.html" target="_blank">Please check cleint table in Database and Class Model </a> to see all properties and attributes in this table .</p>
                                            </div><!--//content-->
                                        </div>

                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How can I add cleint secret? </h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on ClientSecrets table</li>
                                                <li>Insert new record in the table, the ID field represent a foreign key for ID field from clients table  </li>
                                                <li>  You can generate new secret by execute the below code in SQL server (use new query option) to generate secret like "Mysecret".</li>
                                            </ul>

                                        </p>
                                        <pre><code class="language-css">
DECLARE @HASHBYTES VARBINARY(128) = hashbytes('sha2_256', 'Mysecret')
SELECT cast(N'' as xml).value('xs:base64Binary(sql:variable("@HASHBYTES"))', 'varchar(128)');
                                                </code></pre>
                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How can I configure client flow using database?</h3>
                                    <div class="answer">
                                        <p>
                                            <ol class="list">

                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on ClientGrantTypes table</li>
                                                <li>Insert new record in the table, the ID field represent a foreign key for ID field from clients table  </li>
                                                <li>
                                                    Fill the GrantType field with one of the below options (the value is case sensitive, make sure to copy the value):
                                                    <ul>
                                                        <li>client_credentials</li>
                                                        <li>authorization_code</li>
                                                        <li>password</li>
                                                        <li>hybrid</li>

                                                    </ul>
                                                </li>
                                            </ol>
                                        </p>


                                    </div>
                                </div>

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How can I configure client Redirect URL using database?</h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on ClientRedirectUris table</li>
                                                <li>Insert new record in the table, the ID field represent a foreign key for ID field from clients table  </li>
                                                <li> Fill RedirectUri value with URL that  identity server will redirect the end user after log-in </li>
                                            </ul>

                                        </p>


                                    </div>
                                </div>



                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> What are the grant type supported and Which grant type to choose ? </h3>
                                    <div class="answer">
                                        <p>
                                            Grant types are a way to specify how a client wants to interact with IdentityServer. The OpenID Connect and OAuth 2 specs define the following grant types:
                                        </p>
                                        <ul>

                                            <li>
                                                <b>Client credentials:</b> This is the simplest grant type and is used for server to server communication - tokens are always requested on behalf of a client, not a user.

                                                With this grant type you send a token request to the token endpoint, and get an access token back that represents the client. The client typically has to authenticate with the token endpoint using its client ID and secret.
                                                <br />
                                            </li>

                                            <li>
                                                <b>Resource owner password :</b> The resource owner password grant type allows to request tokens on behalf of a user by sending the user’s name and password to the token endpoint. This is so called “non-interactive” authentication and is generally not recommended
                                                <br />
                                                .
                                            </li>

                                            <li>
                                                <b>Implicit : </b>The implicit grant type is optimized for browser-based applications. Either for user authentication-only (both server-side and JavaScript applications), or authentication and access token requests (JavaScript applications).
                                                On the plus side, this is more efficient since it reduces the number of round trips required to get an Access Token. However, a security consideration is that the Access Token is exposed on the client side. Also, note that this flow does not return a Refresh Token because the browser cannot keep it private.
                                                <br />

                                            </li>

                                            <li>
                                                <b>Authorization code:</b>Authorization code flow was originally specified by OAuth 2, and provides a way to retrieve tokens on a back-channel as opposed to the browser front-channel. It also support client authentication.

                                                While this grant type is supported on its own, it is generally recommended you combine that with identity tokens which turns it into the so called hybrid flow. Hybrid flow gives you important extra features like signed protocol responses.

                                                <br />
                                            </li>
                                            <li>
                                                <b>Hybrid :</b>Hybrid flow is a combination of the implicit and authorization code flow - it uses combinations of multiple grant types, most typically code id_token.This is the recommended flow for native applications that want to retrieve access tokens (and possibly refresh tokens as well) and is used for server-side web applications and native desktop/mobile applications.

                                            </li>



                                        </ul>
                                        <p>
                                            Deciding which one is suited for your case depends mostly on your Client's type, but other parameters weigh in as well, like the level of trust for the Client, or the experience you want your users to have.
                                        </p>
                                        <p><b>Is the Client the Resource Owner?</b></p>
                                        <p>
                                            The first decision point is about whether the party that requires access to resources is a machine. In the case of machine-to-machine authorization, the Client is also the Resource Owner, so no end-user authorization is needed.

                                        </p>

                                        <p><b>Is the Client absolutely trusted with user credentials?</b></p>
                                        <p>This grant should only be used when redirect-based flows (like the Authorization Code Flow) are not possible.</p>

                                        <p><b> Is the Client a Single Page App?</b></p>
                                        <p> If the Client is a Single Page App, an application running in a browser using a scripting language like JavaScript, there are two grant options: the Authorization Code Grant using Proof Key for Code Exchange (PKCE) and the Implicit Grant. For most cases, we recommend using the Authorization Code Grant with PKCE.</p>

                                        <p><b> Is the Client a Native/Mobile App?</b></p>
                                        <p>  If the Application is a native app, then the Authorization Code Flow with PKCE (Authorization Code Grant using Proof Key for Code Exchange) should be used.</p>
                                    </div>
                                </div>

                            </section><!--//doc-section-->


                            <section id="Token" class="doc-section">
                                <h2 class="section-title">Token</h2>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to request and validate token using Resource Owner flow ?  </h3>
                                    <div class="answer">

                                        <p>
                                            <ul>
                                                <li> Open postman</li>
                                                <li>
                                                    Fill the infromation needed to request a token as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS470.png" alt="elegant icons" />
                                                </li>
                                                <li>
                                                    Copy the Access token and test the token by access a demo application deployed in the server as the following:
                                                    <img class="img-fluid" src="assets/images/demo/IDS471.png" alt="elegant icons" />



                                                </li>

                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to request and validate token using Authorization Code flow ? </h3>
                                    <div class="answer">
                                        <p>we will use postman Canary isntead of postman because flows like implicit, authorization code and hybrid are not compatible with the current identity server 4 when using .net core 2.1.</p>
                                        <p>
                                            <ul>
                                                <li> Open postman Canary</li>
                                                <li>
                                                    Fill the infromation needed to request a token as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS490.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Fill the user name and password for the user as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS491.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>

                                                    Postman Canary will redirect you to confrimation page to grant your permission, clcik on "Yes ,allow" :

                                                    <img class="img-fluid" src="assets/images/demo/IDS492.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Postman Canary will dsiplay a new token ,copy the token or click on "Use Token" button:
                                                    <img class="img-fluid" src="assets/images/demo/IDS493.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Copy the Access token and test the token by access a demo application deployed in the server as the following:
                                                    <img class="img-fluid" src="assets/images/demo/IDS471.png" alt="elegant icons" />
                                                    <br />

                                                </li>

                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->


                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to request and validate token using Authorization Code flow (Postamn and browser) ? <span class="badge badge-success">Updated version 1.3.0</span></h3>
                                    <div class="answer">
                                        <p></p>

                                        <p>we will use postman Canary isntead of postman because flows like implicit, authorization code and hybrid are not compatible with the current identity server 4 when using .net core 2.1.</p>
                                        <p>
                                            <ul>
                                                <li> Open browser like Chrome</li>
                                                <li>
                                                    Copy the below URL to request an authorization code:
                                                    “https://identity.jamsheed.com/connect/authorize?scope=web_api&response_type=code&client_id=clientauthcode&redirect_uri=https://localhost:44390/callback.html&grant_type=authorization_code&state=abc “
                                                </li>
                                                <li>
                                                    The browser will redirect you to login page, fill a user credentials and click on login button
                                                    <img class="img-fluid" src="assets/images/demo/IDS4110.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>

                                                    Identity server will redirect you to grant permission page, click on “Yes, allow”

                                                    <img class="img-fluid" src="assets/images/demo/IDS4111.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    The browser will redirect you to broken page, copy the code from the authorization from the response URL
                                                    <img class="img-fluid" src="assets/images/demo/IDS4112.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Go to Postman Canary and fill a Post request with following values
                                                    <img class="img-fluid" src="assets/images/demo/IDS4113.png" alt="elegant icons" />
                                                    <br />

                                                </li>

                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->



                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to request and validate token using Implicit flow? </h3>
                                    <div class="answer">
                                        <p>we will use postman Canary isntead of postman because flows like implicit, authorization code and hybrid are not compatible with the current identity server 4 when using .net core 2.1.</p>
                                        <p>
                                            <ul>
                                                <li> Open postman Canary</li>
                                                <li>
                                                    Fill the infromation needed to request a token as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS494.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Fill the user name and password for the user as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS491.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>

                                                    Postman Canary will redirect you to confrimation page to grant your permission, clcik on "Yes ,allow" :

                                                    <img class="img-fluid" src="assets/images/demo/IDS495.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Postman Canary will dsiplay a new token ,copy the token or click on "Use Token" button:
                                                    <img class="img-fluid" src="assets/images/demo/IDS496.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Copy the Access token and test the token by access a demo application deployed in the server as the following:
                                                    <img class="img-fluid" src="assets/images/demo/IDS471.png" alt="elegant icons" />
                                                    <br />

                                                </li>

                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to request token and validate using client credentials flow? </h3>
                                    <div class="answer">
                                        <p>we will use postman Canary isntead of postman because flows like implicit, authorization code and hybrid are not compatible with the current identity server 4 when using .net core 2.1.</p>
                                        <p>
                                            <ul>
                                                <li> Open postman Canary</li>
                                                <li>
                                                    Fill the infromation needed to request a token as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS497.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Fill the user name and password for the user as follwoing:
                                                    <img class="img-fluid" src="assets/images/demo/IDS491.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>

                                                    Postman Canary will redirect you to confrimation page to grant your permission, clcik on "Yes ,allow" :

                                                    <img class="img-fluid" src="assets/images/demo/IDS498.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Postman Canary will dsiplay a new token ,copy the token or click on "Use Token" button:
                                                    <img class="img-fluid" src="assets/images/demo/IDS499.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Copy the Access token and test the token by access a demo application deployed in the server as the following:
                                                    <img class="img-fluid" src="assets/images/demo/IDS471.png" alt="elegant icons" />
                                                    <br />

                                                </li>

                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to change Access token expiration period?  </h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on Clients table</li>
                                                <li> Change the AccessTokenLifetime (defaults to 3600 seconds / 1 hour) </li>
                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to change Access token Type (JWT or Reference)? </h3>
                                    <div class="answer">
                                        <p>
                                            A JWT token would be a self-contained access token - it’s a protected data structure with claims and an expiration. Once an API has learned about the key material, it can validate self-contained tokens without needing to communicate with the issuer. This makes JWTs hard to revoke. They will stay valid until they expire.
                                        </p>
                                        <p>  When using reference tokens - IdentityServer will store the contents of the token in a data store and will only issue a unique identifier for this token back to the client. The API receiving this reference must then open a back-channel communication to IdentityServer to validate the token.</p>
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on Clients table</li>
                                                <li> Change the AccessTokenType (default is 0  JWT token) </li>
                                            </ul>
                                        </p>


                                    </div>
                                </div><!--//section-block-->
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to Enable referesh token option?</h3>
                                    <div class="answer">
                                        <p>
                                            Since access tokens have finite lifetimes, refresh tokens allow requesting new access tokens without user interaction.
                                        </p>
                                        <p>
                                            Refresh tokens are supported for the following flows: authorization code, hybrid and resource owner password credential flow. The clients needs to be explicitly authorized to request refresh tokens by setting AllowOfflineAccess to true.
                                        </p>
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on Clients table</li>
                                                <li> Change the AllowOfflineAccess to 1 </li>
                                            </ul>
                                        </p>

                                    </div>
                                </div><!--//section-block-->
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>How to manage refresh token expiration?</h3>
                                    <div class="answer">
                                        <p>Identity server offer to options to manage refresh token expiration:</p>
                                        <p>
                                            <ul>
                                                <li>Sliding </li>
                                                <li>Absolute </li>
                                            </ul>
                                        </p>
                                        <p><strong>Sliding means 2 things:</strong></p>
                                        <p>
                                            <ul>
                                                <li>When the refresh token is first created, it will have a lifetime of SlidingRefreshTokenLifetime</li>
                                                <li>When you use the refresh token lifetime, its new lifetime will be now + SlidingRefreshTokenLifetime or creation time + AbsoluteRefreshTokenLifetime, whichever the lower.</li>
                                            </ul>
                                        </p>
                                        <p>Quick example, let's say you have a SlidingRefreshTokenLifetime of 10 and a AbsoluteRefreshTokenLifetime of 30:</p>
                                        <p>
                                            <ol>
                                                <li>The refresh token is created at time T0</li>
                                                <li>You use it at time T8 to get a new access token. Its new expiration time is T18</li>
                                                <li>You use it again at T17 which makes it expire at T27</li>
                                                <li>You use it once again at T25. Here the absolute expiration time, T30, is lower than the new sliding expiration time, T35, so T30 it is</li>

                                            </ol>
                                        </p>
                                        <p>
                                            Let's say the token lifetime can be extended, but its entire lifetime will be never be greater than the absolute lifetime.

                                            Finally, RefreshToken.AbsoluteRefreshTokenLifetime doesn't involve sliding expiration, so the SlidingRefreshTokenLifetime is not used. The refresh token will be valid for AbsoluterefreshTokenLifetime after it was created.
                                        </p>
                                        <p>To change these settigs please follow the below settings:</p>
                                        <p>
                                            <ul>
                                                <li> Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on Clients table</li>
                                                <li> Change  RefreshTokenExpiration (Absolute 1) (Sliding  0)</li>
                                                <li>Change AbsoluteRefreshTokenLifetime value (Maximum lifetime of a refresh token in seconds. Defaults to 2592000 seconds / 30 days)</li>
                                                <li>Change SlidingRefreshTokenLifetime value (Sliding lifetime of a refresh token in seconds. Defaults to 1296000 seconds / 15 days)</li>
                                                <li>Change RefreshTokenUsage value (<strong>ReUse</strong> the refresh token handle will stay the same when refreshing tokens) (<strong>OneTime</strong> the refresh token handle will be updated when refreshing tokens. This is the default.)</li>
                                                <li> Change AccessTokenType value (Reference Token 0)(JWT 1)</li>
                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>How to monitor token expiration?</h3>
                                    <div class="answer">
                                        <ul>
                                            <li> Open SQL server</li>
                                            <li>Open ComsoftIdentityServer database</li>
                                            <li> Check data in PersistedGrants table</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to request refresh token ? </h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li> Open postman </li>
                                                <li>
                                                    Fill the infromation needed to request a token as follwoing and make sure to fill "offline_access" scope:
                                                    <img class="img-fluid" src="assets/images/demo/IDS4101.png" alt="elegant icons" />
                                                    <br />
                                                </li>
                                                <li>
                                                    Postman will display the refresh token at the end of response , please refer to the below screenshot:
                                                    <img class="img-fluid" src="assets/images/demo/IDS4102.png" alt="elegant icons" />
                                                    <br />
                                                </li>



                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->
                            </section><!--//doc-section-->

                            <section id="Scope" class="doc-section">
                                <h2 class="section-title">Scope Management</h2>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>How to assign scopes for a client?  </h3>
                                    <div class="answer">
                                        
                                        <ul>
                                            <li> Open SQL server</li>
                                            <li>Open ComsoftIdentityServer database</li>
                                            <li>
                                                Open Clients table and get the ID as following:
                                                <img class="img-fluid" src="assets/images/demo/IDS481.png" alt="elegant icons" />
                                            </li>

                                            <li>Open ClientScopes table and assign the built-in scopes like openid and profile for this client, or you can assign API resources like web_api to this client as following :

                                                <img class="img-fluid" src="assets/images/demo/IDS482.png" alt="elegant icons" />

                                            </li>

                                        </ul>
                                       
                                    </div>
                                </div><!--//section-block-->

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to add new API resource like web_api?</h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li>Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li> Right click on ApiResources table and choose edit</li>
                                                <li>
                                                    Fill a new record with new name like the following record :
                                                    <img class="img-fluid" src="assets/images/demo/IDS483.png" alt="elegant icons" />
                                                </li>
                                                <li> Then Right click on ApiScopes table and choose edit</li>
                                                <li>
                                                    Fill a new record with the same name for the same name of API, you need to link the API added in the previous step by filling the ApiresourceId field like the following: 
                                                    <img class="img-fluid" src="assets/images/demo/IDS484.png" alt="elegant icons" />
                                                </li>
                                            </ul>
                                        </p>
                                    </div>
                                </div><!--//section-block-->
                                
                            </section>

                            <section id="API" class="doc-section">
                                <h2 class="section-title">API</h2>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to add new API resource?</h3>
                                    <div class="answer">
                                        <ul>
                                            <li>Open SQL server</li>
                                            <li>Open ComsoftIdentityServer database</li>
                                            <li>Add new record in ApiResources table (ex name: APIabc) (</li>
                                        </ul>
                                        <p>Then grant access for APIabc to specific Client with the following steps:</p>
                                        <p>
                                            <ul>
                                                <li>Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li>Add new record in ClientScopes table (</li>
                                            </ul>
                                        </p>
                                        <p>Update Startup class for cleint to request this API in scope and update API startup, please refer to <a href="Topics.html">Protecting APIs section</a> in Topics and References page.</p>
                                    </div>
                                </div><!--//section-block-->

                            </section><!--//doc-section-->

                            <section id="UserAccount" class="doc-section">
                                <h2 class="section-title">User Account</h2> 
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to Add user account using API ?</h3> 
                                    <div class="answer">
                                        <p>
                                            Comsoft Identity server is offering an integration point to add user account by calling the below API end point:
                                        </p>
                                        <p><i><b>IdentityServerURL</b></i>/CustomAccount/RegisterUserAsync </p>
                                        <p>This API required to send Username which is the same as email and password . </p>

                                    </div>
                                </div>

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to Add user account using Database ?</h3>
                                    <div class="answer">
                                        <p>
                                            <ul>
                                                <li>Open SQL server</li>
                                                <li>Open ComsoftIdentityServer database</li>
                                                <li>Add new record in AspNetUsers table (Make sure that IsEnabled and EmailConfirmed flags marked as true) (</li>
                                            </ul>
                                        </p>
                                    </div>
                                </div>

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to change user password using API ?</h3>
                                    <div class="answer">
                                        <p>
                                            Comsoft Identity server is offering an integration point to change user password by calling the below <strong>Authorized </strong> API end point:
                                        </p>
                                        <p><i><b>IdentityServerURL</b></i>/CustomAccount/ChangeUserPasswordAsync </p>
                                        <p>This API required to send: </p>
                                        <ul>
                                            <li>Username</li>
                                            <li>Old Password</li>
                                            <li>New Password</li>
                                        </ul>

                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to reset user password using API ?</h3>
                                    <div class="answer">
                                        <p>
                                            Comsoft Identity server is offering an integration point to reset user password ,this operation should be done in 2 steps :
                                        </p>

                                        <ol>
                                            <li>
                                                <p><strong>Request Reset Token:</strong> The user request a reset token by calling <i><b>IdentityServerURL</b></i>/account/GeneratePasswordResetTokenAsync</p>
                                                <p>This API required to send UserName.</p>
                                            </li>

                                            <li>
                                                <p><strong> Reset Password:</strong> The user reset password by calling <i><b>IdentityServerURL</b></i>/CustomAccount/ResetUserPasswordAsync</p>
                                                <p>
                                                    This API required to send the follwoing:

                                                    <ul>
                                                        <li>Username</li>
                                                        <li>New Password</li>
                                                        <li>Reset Token</li>

                                                    </ul>.
                                                </p>
                                            </li>
                                        </ol>



                                    </div>
                                </div>
                            </section>


                            <section id="IdentityServerManagement" class="doc-section">
                                <h2 class="section-title">Identity Server Management</h2>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> How to manage password complexity?</h3>
                                    <div class="answer">
                                        <p>The admin can manage and modify password complexity for user registration process from identity server web.config (C:\Identity Server\IIS files\Identity server Site), the configuration will help the user to modify the below password options:</p>
                                        <ol>
                                            <li> <b>Require digit(true,false):</b> a flag indicating if passwords must contain a digit. Defaults to true</li>
                                            <li> <b>Require Lower case (true,false):</b> flag indicating if passwords must contain a lower case ASCII character. Defaults to true.</li>
                                            <li> <b>Require Non Alphanumeric (true,false) :</b> flag indicating if passwords must contain a non-alphanumeric character. Defaults to true.</li>
                                            <li> <b> Require Uppercase (true,false):</b> flag indicating if passwords must contain a upper case ASCII character. Defaults to true.</li>
                                            <li> <b>Required Length (number):</b> the minimum length a password must be. Defaults to 6.</li>
                                            <li> <b>Required Unique Chars (number):</b> the minimum number of unique characters which a password must contain)</li>

                                        </ol>
                                        <p><b> Note</b> : changes on these options will reflected globally to all clients connected to identity server.</p>
                                    </div>
                                </div>

                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i> Where to check Comsoft Identity Sever Logs?</h3>
                                    <div class="answer">
                                        <p>
                                            Comsoft Identity server rely on Serilog tool to log errors, warnings and transactions, Serilog configured to use text file please find below the path for this file over the server:
                                        </p>
                                        <p><pre><code class="language-markup">C:\Identity Server\IIS files\Identity server Site\identityserver4_log.txt</code></pre></p>
                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>How can I clean existing Database?</h3>
                                    <div class="answer">
                                        <p>
                                            The admin can run a custom script for cleaning all database tables in addition to reset all indexes, the admin can find this script on identity server in the below location:
                                        </p>
                                        <p><pre><code class="language-markup">C:\Identity Server\Database\Clean Scripts\Script_CleanIDS4_DB_V1.0</code></pre></p>
                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>Where can i find a clean database?</h3>
                                    <div class="answer">
                                        <p>
                                            The below location on the server hold clean backups from the latest databases, the admin need to restore the latest database for if there need to run a new copy from Comsoft identity server:
                                        </p>
                                        <p><pre><code class="language-markup">C:\Identity Server\Database\Database versions\<i>Latestcopy.bak</i></code></pre></p>
                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>Where is the latest source code?</h3>
                                    <div class="answer">
                                        <p>
                                            The latest source code has been copied over the server in the below location:
                                        </p>
                                        <p><pre><code class="language-markup">C:\Identity Server\Source Code</code></pre></p>
                                    </div>
                                </div>
                                <div class="section-block">
                                    <h3 class="question"><i class="fas fa-question-circle"></i>Where is the deployment location?</h3>
                                    <div class="answer">
                                        <p>
                                            The project deployed in the below location:
                                        </p>
                                        <p><pre><code class="language-markup">C:\Identity Server\IIS files\Identity server Site\</code></pre></p>
                                    </div>
                                </div>

                            </section>

                        </div><!--//content-inner-->
                     </div>
                    <div class="doc-sidebar col-md-3 col-12 order-0 d-none d-md-flex">
                                    <div id="doc-nav" class="doc-nav">
                                        <nav id="doc-menu" class="nav doc-menu flex-column sticky">
                                            <a class="nav-link scrollto" href="#Clients">Clients</a>
                                            <a class="nav-link scrollto" href="#Token">Token</a>
                                            <a class="nav-link scrollto" href="#Scope">Scope Management</a>
                                            <a class="nav-link scrollto" href="#API">API</a>
                                            <a class="nav-link scrollto" href="#UserAccount">User Account</a>
                                            <a class="nav-link scrollto" href="#IdentityServerManagement">Identity Server Management</a>
                                        </nav><!--//doc-menu-->
                                    </div>
                                </div><!--//doc-sidebar-->
                </div><!--//doc-body-->  
            </div><!--//container-->
        </div><!--//doc-wrapper-->
        
        <div id="promo-block" class="promo-block">
            <div class="container">
                <div class="promo-block-inner">
                   
                    <div class="row">
                       </div><!--//row-->
                </div><!--//promo-block-inner-->  
            </div><!--//container-->
        </div><!--//promo-block-->
        
    </div><!--//page-wrapper-->
    
    <footer id="footer" class="footer text-center">
        <div class="container">
            <!--/* This template is released under the Creative Commons Attribution 3.0 License. Please keep the attribution link below when using for your own project. Thank you for your support. :) If you'd like to use the template without the attribution, you can buy the commercial license via our website: themes.3rdwavemedia.com */-->
            <small class="copyright"></small>
            
        </div><!--//container-->
    </footer><!--//footer-->
    
     
    <!-- Main Javascript -->          
    <script type="text/javascript" src="assets/plugins/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="assets/plugins/prism/prism.js"></script>    
    <script type="text/javascript" src="assets/plugins/jquery-scrollTo/jquery.scrollTo.min.js"></script>  
    <script type="text/javascript" src="assets/plugins/lightbox/dist/ekko-lightbox.min.js"></script>   
    <script type="text/javascript" src="assets/plugins/stickyfill/dist/stickyfill.min.js"></script>                                                                
    <script type="text/javascript" src="assets/js/main.js"></script>
    
</body>
</html> 

